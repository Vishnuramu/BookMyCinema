{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Choose location â€” BookMyCinema</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        :root{
          --brand-font: "Poppins", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
          --muted: #666;
          --dark: #111;
          --btn-bg: #1f2937;
        }
        html,body{margin:0;padding:0;font-family:var(--brand-font);background:#f6f6f6;color:var(--dark);}

        /* header */
        header{width:100%;background:#fff;padding:14px 40px;display:flex;justify-content:space-between;align-items:center;box-sizing:border-box;position:relative;border-bottom:1px solid #eee}
        .logo{display:inline-flex;align-items:center;gap:8px;font-weight:700;font-size:20px}
        .logo span:first-child{font-size:22px}
        .header-right{display:flex;align-items:center;gap:28px}

        /* location dropdown in header */
        #location-toggle{display:flex;align-items:center;gap:8px;cursor:pointer;padding:6px 10px;border-radius:6px}
        #arrow-icon{width:8px;height:8px;border-right:2px solid #555;border-bottom:2px solid #555;display:inline-block;transform:rotate(315deg);transition:0.15s}
        #city-dropdown{position:absolute;top:100%;left:0;background:#fff;border:1px solid #ddd;border-radius:8px;padding:6px 0;min-width:180px;box-shadow:0 6px 18px rgba(0,0,0,0.08);display:none;z-index:50}
        #city-dropdown div{padding:8px 12px;cursor:pointer;display:flex;align-items:center;gap:8px}
        #city-dropdown div:hover{background:#f5f5f5}

        /* coins & profile */
        .coins{background:#efefef;padding:6px 12px;border-radius:20px;font-weight:700;display:flex;align-items:center;gap:8px}
        .avatar{width:38px;height:38px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:#1e293b;color:#fff}

        /* popup backdrop */
        #city-popup-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.45);backdrop-filter:blur(5px);display:none;align-items:center;justify-content:center;z-index:9999}

        /* popup box */
        #city-popup{width:92%;max-width:1100px;background:#fff;padding:34px;border-radius:14px;box-shadow:0 18px 50px rgba(0,0,0,0.25);display:flex;flex-direction:column;align-items:center;box-sizing:border-box;height:520px}
        #city-popup h2{margin:0;font-size:28px;font-weight:700}
        #city-popup p{margin:6px 0 0;color:var(--muted);font-size:13px}

        /* IMAGES ROW (single horizontal row of 5 items) */
        .images-row-wrap {
            width:100%;
            display:flex;
            justify-content:center;
            margin:18px 0;
        }

        .images-row {
    display:flex;
    gap:28px;
    align-items:flex-start;
    justify-content:flex-start;  /* important: do NOT center */
    overflow-x: auto;
    overflow-y: hidden;
    padding: 10px 0;
    width:100%;
    scroll-behavior: smooth;       /* smooth swipe */
    -webkit-overflow-scrolling: touch; /* iOS smooth scroll */
}
.images-row::-webkit-scrollbar {
    display: none;
}
.images-row {
    -ms-overflow-style: none;  /* IE */
    scrollbar-width: none;     /* Firefox */
}

        .image-card {
            width:160px;
            display:flex;
            flex-direction:column;
            align-items:center;
            gap:10px;
            flex: 0 0 auto;
        }

        .image-box {
            width:160px;
            height:200px;
            background:#fff;
            border-radius:8px;
            overflow:hidden;
            display:flex;
            align-items:center;
            justify-content:center;
            box-sizing:border-box;
            border:none; /* removed border */
        }

        .image-box img {
            width:100%;
            height:100%;
            object-fit:contain;
            display:block;
        }

        .image-action {
            width:100%;
            display:flex;
            justify-content:center;
        }

        /* per-image button */
        .image-select-btn {
            padding:10px 14px;
            font-size:14px;
            font-weight:700;
            background:var(--btn-bg);
            color:#fff;
            border-radius:8px;
            border:none;
            cursor:pointer;
            min-width:120px;
        }
        .image-select-btn:hover{background:#111}

        /* responsive adjustments */
        @media (max-width:900px){
            .image-card{ width:140px; }
            .image-box{ width:140px; height:170px; }
            .image-select-btn{ min-width:110px; padding:9px 12px; font-size:13px; }
        }
        @media (max-width:540px){
            #city-popup{height:auto;padding:22px}
            .image-card{ width:120px; }
            .image-box{ width:120px; height:150px; }
            .image-select-btn{ min-width:100px; padding:8px 10px; font-size:13px; }
        }
    </style>
</head>
<body>

<!-- POPUP BACKDROP + BOX -->
<div id="city-popup-backdrop" role="dialog" aria-modal="true" aria-label="Choose your location">
    <div id="city-popup">
        <div style="text-align:center">
            <h2>Choose your location</h2>
            <p>(Currently the service is available in Chennai only)</p>
        </div>

        <!-- images row -->
        <div class="images-row-wrap" aria-hidden="false">
            <div class="images-row" role="list">
                <!-- Chennai -->
                <div class="image-card" role="listitem">
                    <div class="image-box">
                        <img src="{% static 'movies/chennai1.png' %}" alt="Chennai">
                    </div>
                    <div class="image-action">
                        <button class="image-select-btn" onclick="selectCityPopup('Chennai')">Chennai</button>
                    </div>
                </div>

                <!-- Dindigul -->
                <div class="image-card" role="listitem">
                    <div class="image-box">
                        <img src="{% static 'movies/dindigul1.png' %}" alt="Dindigul">
                    </div>
                    <div class="image-action">
                        <button class="image-select-btn" onclick="selectCityPopup('Dindigul')">Dindigul</button>
                    </div>
                </div>

                <!-- Madurai -->
                <div class="image-card" role="listitem">
                    <div class="image-box">
                        <img src="{% static 'movies/madurai5.png' %}" alt="Madurai">
                    </div>
                    <div class="image-action">
                        <button class="image-select-btn" onclick="selectCityPopup('Madurai')">Madurai</button>
                    </div>
                </div>

                <!-- Coimbatore -->
                <div class="image-card" role="listitem">
                    <div class="image-box">
                        <img src="{% static 'movies/covai1.png' %}" alt="Coimbatore">
                    </div>
                    <div class="image-action">
                        <button class="image-select-btn" onclick="selectCityPopup('Coimbatore')">Coimbatore</button>
                    </div>
                </div>

                <!-- Tiruchi -->
                <div class="image-card" role="listitem">
                    <div class="image-box">
                        <img src="{% static 'movies/thiruchi.png' %}" alt="Tiruchi">
                    </div>
                    <div class="image-action">
                        <button class="image-select-btn" onclick="selectCityPopup('Tiruchi')">Tiruchi</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- HEADER -->
<header>
    <div class="logo">
        <span>B</span>
        <svg width="65" height="50" viewBox="0 0 64 48" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-top:-6px">
            <path d="M16 20 L24 8 H40 L48 20 Z" transform="translate(0, -5)" />
            <rect x="12" y="20" width="40" height="6" transform="translate(0, -5)" />
            <circle cx="22" cy="32" r="7" stroke-width="4" fill="none" />
            <circle cx="42" cy="32" r="7" stroke-width="4" fill="none" />
            <path d="M31 32 H33" stroke-width="3" stroke-linecap="round" />
        </svg>
        <span>KmyCinema</span>
    </div>

    <div class="header-right">
        <div style="position:relative">
            <div id="location-toggle" onclick="toggleCityDropdown()" aria-haspopup="true" aria-expanded="false">
                <span id="arrow-icon"></span>
                <span id="current-city">{{ city|default:"Select Location" }}</span>
            </div>

            <div id="city-dropdown" aria-hidden="true">
                <div onclick="selectCity('Chennai')">Chennai</div>
                <div onclick="selectCity('Dindigul')">Dindigul</div>
                <div onclick="selectCity('Madurai')">Madurai</div>
                <div onclick="selectCity('Coimbatore')">Coimbatore</div>
                <div onclick="selectCity('Tiruchi')">Tiruchi</div>
            </div>
        </div>

        <div class="coins">â‚¿ <span>{{ coins|default:"0" }} Coins</span></div>
        <div class="avatar" title="Profile">ðŸ‘¤</div>
    </div>
</header>

<hr style="margin:0;border:none;border-top:1px solid #eee">

<main>
    {% block content %}
    {% endblock %}
</main>

<script>
function openCityPopup(){
    const backdrop = document.getElementById('city-popup-backdrop');
    backdrop.style.display = 'flex';
    document.body.style.overflow = 'hidden';
}

function closeCityPopup(){
    const backdrop = document.getElementById('city-popup-backdrop');
    backdrop.style.display = 'none';
    document.body.style.overflow = '';
}

function selectCityPopup(city){
    closeCityPopup();
    const encoded = encodeURIComponent(city.toLowerCase());
    window.location.href = "/homepage/" + encoded + "/";
}

function toggleCityDropdown(){
    const dd = document.getElementById('city-dropdown');
    const arrow = document.getElementById('arrow-icon');
    const isOpen = dd.style.display === 'block';
    dd.style.display = isOpen ? 'none' : 'block';
    arrow.style.transform = isOpen ? 'rotate(315deg)' : 'rotate(405deg)';
}

function selectCity(city){
    document.getElementById('current-city').textContent = city;
    document.getElementById('city-dropdown').style.display = 'none';
    document.getElementById('arrow-icon').style.transform = 'rotate(315deg)';
}

document.getElementById('city-popup-backdrop').addEventListener('click', function(e){
    const popup = document.getElementById('city-popup');
    if (e.target === this) closeCityPopup();
});

window.addEventListener('load', function(){
    openCityPopup();
});
</script>
</body>
</html>
